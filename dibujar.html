<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Drawing Tool</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(120deg, #1e1e1e, #2b2b2b, #3c3c3c);
            background-size: 400% 400%;
            animation: gradientBackground 30s ease infinite;
            color: #f1f1f1;
        }

        @keyframes gradientBackground {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        #controls {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            gap: 10px;
            z-index: 10;
        }

        select, button, input[type="color"] {
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            border: none;
            background-color: #444;
            color: #f1f1f1;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }

        select:hover, button:hover, input[type="color"]:hover {
            background-color: #555;
        }

        canvas {
            border: 2px solid #007bff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            background-color: rgba(43, 43, 43, 0.8);
            z-index: 5;
        }

        .title {
            font-size: 24px;
            margin-top: 20px;
            margin-bottom: 10px;
            color: #007bff;
            z-index: 10;
        }

        #background-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            opacity: 0.7;
        }
    </style>
</head>

<body>
    <h1 class="title">Canvas Drawing Tool</h1>
    <div id="controls">
        <label for="shape">Select Shape:</label>
        <select id="shape">
            <option value="rectangle">Rectangle</option>
            <option value="circle">Circle</option>
            <option value="triangle">Triangle</option>
            <option value="star">Star</option>
        </select>
        <label for="color">Select Color:</label>
        <input type="color" id="color" value="#ff0000">
        <button id="clear">Clear Canvas</button>
    </div>
    <canvas id="canvas" width="800" height="600"></canvas>
    <canvas id="background-animation"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const shapeSelect = document.getElementById('shape');
        const colorInput = document.getElementById('color');
        const clearButton = document.getElementById('clear');
        const backgroundCanvas = document.getElementById('background-animation');
        const bgCtx = backgroundCanvas.getContext('2d');

        backgroundCanvas.width = window.innerWidth;
        backgroundCanvas.height = window.innerHeight;

        let currentShape = 'rectangle';
        let currentColor = '#ff0000';
        let shapes = [];

        shapeSelect.addEventListener('change', (e) => {
            currentShape = e.target.value;
        });

        colorInput.addEventListener('input', (e) => {
            currentColor = e.target.value;
        });

        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const shape = createShape(currentShape, x, y, currentColor);
            shapes.push(shape);
            drawShapes();
        });

        function createShape(type, x, y, color) {
            return {
                type,
                x,
                y,
                color,
                opacity: Math.random() * 0.5 + 0.5, // Opacidad aleatoria entre 0.5 y 1
                fadeSpeed: Math.random() * 0.02 + 0.01 // Velocidad de desvanecimiento
            };
        }

        function drawShapes() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            shapes.forEach((shape) => {
                ctx.beginPath();
                ctx.globalAlpha = shape.opacity;
                ctx.fillStyle = shape.color;
                ctx.strokeStyle = shape.color;
                ctx.lineWidth = 3;
                
                if (shape.type === 'rectangle') {
                    ctx.roundRect(shape.x, shape.y, 120, 60, 10);
                } else if (shape.type === 'circle') {
                    ctx.arc(shape.x, shape.y, 50, 0, Math.PI * 2);
                } else if (shape.type === 'triangle') {
                    ctx.moveTo(shape.x, shape.y);
                    ctx.lineTo(shape.x + 80 / 2, shape.y + 80);
                    ctx.lineTo(shape.x - 80 / 2, shape.y + 80);
                    ctx.closePath();
                } else if (shape.type === 'star') {
                    drawStar(ctx, shape.x, shape.y, 60);
                }
                
                ctx.fill();
                ctx.stroke();
                ctx.globalAlpha = 1; // Resetear opacidad para otras formas
            });
        }

        function drawStar(ctx, x, y, radius) {
            const spikes = 5;
            const outerRadius = radius;
            const innerRadius = radius / 2;
            let rot = Math.PI / 2 * 3;
            let cx = x;
            let cy = y;
            let step = Math.PI / spikes;

            ctx.moveTo(cx, cy - outerRadius);
            for (let i = 0; i < spikes; i++) {
                cx = x + Math.cos(rot) * outerRadius;
                cy = y + Math.sin(rot) * outerRadius;
                ctx.lineTo(cx, cy);
                rot += step;

                cx = x + Math.cos(rot) * innerRadius;
                cy = y + Math.sin(rot) * innerRadius;
                ctx.lineTo(cx, cy);
                rot += step;
            }
            ctx.lineTo(x, y - outerRadius);
            ctx.closePath();
        }

        clearButton.addEventListener('click', () => {
            shapes = [];
            drawShapes();
        });

        CanvasRenderingContext2D.prototype.roundRect = function (x, y, width, height, radius) {
            if (width < 2 * radius) radius = width / 2;
            if (height < 2 * radius) radius = height / 2;
            this.moveTo(x + radius, y);
            this.arcTo(x + width, y, x + width, y + height, radius);
            this.arcTo(x + width, y + height, x, y + height, radius);
            this.arcTo(x, y + height, x, y, radius);
            this.arcTo(x, y, x + width, y, radius);
            this.closePath();
            return this;
        };

        let bgShapes = [];

        function createBgShapes() {
            const colors = ['rgba(255, 77, 77, 0.2)', 'rgba(77, 255, 77, 0.2)', 'rgba(77, 77, 255, 0.2)', 'rgba(255, 255, 77, 0.2)'];
            for (let i = 0; i < 30; i++) {
                const x = Math.random() * backgroundCanvas.width;
                const y = Math.random() * backgroundCanvas.height;
                const radius = Math.random() * 50 + 30;
                const dx = (Math.random() - 0.5) * 2;
                const dy = (Math.random() - 0.5) * 2;
                const color = colors[Math.floor(Math.random() * colors.length)];

                bgShapes.push({ x, y, radius, dx, dy, color });
            }
        }

        function animateBackground() {
            bgCtx.clearRect(0, 0, backgroundCanvas.width, backgroundCanvas.height);

            bgShapes.forEach(shape => {
                shape.x += shape.dx;
                shape.y += shape.dy;

                if (shape.x + shape.radius > backgroundCanvas.width || shape.x - shape.radius < 0) {
                    shape.dx = -shape.dx;
                }
                if (shape.y + shape.radius > backgroundCanvas.height || shape.y - shape.radius < 0) {
                    shape.dy = -shape.dy;
                }

                bgCtx.beginPath();
                bgCtx.arc(shape.x, shape.y, shape.radius, 0, Math.PI * 2);
                bgCtx.fillStyle = shape.color;
                bgCtx.fill();
            });

            requestAnimationFrame(animateBackground);
        }

        createBgShapes();
        animateBackground();
    </script>
</body>

</html>
